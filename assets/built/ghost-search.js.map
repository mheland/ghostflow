{"version":3,"sources":["ghost-search.js"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","_typeof","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","_createClass","protoProps","staticProps","root","UMD","define","amd","module","exports","fuzzysort","this","isNode","require","window","preparedCache","Map","preparedSearchCache","noResults","total","matchesSimple","matchesStrict","cleanup","clear","defaultScoreFn","a","max","result","score","getValue","prop","tmp","undefined","segs","Array","isArray","split","len","isObj","x","fastpriorityqueue","r","o","e","n","c","f","add","poll","peek","replaceTop","q","fuzzysortNew","instanceOptions","single","search","options","getPreparedSearch","getPrepared","allowTypo","algorithm","algorithmNoTypo","go","targets","searchLowerCode","prepareSearch","threshold","limit","resultsLen","limitedCount","targetsLen","keys","scoreFn","keysLen","objResults","keyI","_targetLowerCodes","_nextBeginningIndexes","indexes","results","goAsync","canceled","p","Promise","resolve","reject","iCurrent","step","startMs","Date","now","setImmediate","setTimeout","cancel","highlight","hOpen","hClose","highlighted","matchesIndex","opened","targetLen","matchesBest","char","substr","prepare","prepareLowerCodes","prepareSlow","prepareNextBeginningIndexes","targetPrepared","get","set","searchPrepared","searchLowerCodes","prepared","targetLowerCodes","searchLen","searchI","targetI","typoSimpleI","matchesSimpleLen","typoStrictI","successStrict","matchesStrictLen","nextBeginningIndexes","firstPossibleI","matchesBestLen","lastTargetI","str","strLen","lowerCodes","lower","toLowerCase","charCodeAt","prepareBeginningIndexes","beginningIndexes","beginningIndexesLen","wasUpper","wasAlphanum","targetCode","isUpper","isAlphanum","isBeginning","lastIsBeginning","lastIsBeginningI","new","GhostSearch","args","defaults","host","version","input","button","defaultValue","template","location","protocol","join","slug","title","trigger","check","api","resource","parameters","fields","filter","include","order","formats","page","on","beforeDisplay","afterDisplay","beforeFetch","afterFetch","merged","mergeDeep","assign","init","source","_this","forEach","_this2","ghostAPI","GhostContentAPI","browse","then","data","catch","err","console","error","htmlString","div","document","createElement","innerHTML","trim","firstChild","querySelectorAll","removeChild","inputValue","appendChild","createElementFromHTML","_this3","displayResults","tagName","type","closest","addEventListener","preventDefault","log","checkArgs","_this4","validate","onload","fetch"],"mappings":"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","file":"ghost-search.js","sourcesContent":["/**\n * ghost-search 1.0.1 (https://github.com/HauntedThemes/ghost-search)\n * A simple but powerful search library for Ghost Blogging Platform.\n * Copyright 2019 Haunted Themes (https://www.hauntedthemes.com)\n * Released under MIT License\n * Released on: 28 Jan 2019\n */\n\n/*\nWHAT: SublimeText-like Fuzzy Search\n\nUSAGE:\n  fuzzysort.single('fs', 'Fuzzy Search') // {score: -16}\n  fuzzysort.single('test', 'test') // {score: 0}\n  fuzzysort.single('doesnt exist', 'target') // null\n\n  fuzzysort.go('mr', ['Monitor.cpp', 'MeshRenderer.cpp'])\n  // [{score: -18, target: \"MeshRenderer.cpp\"}, {score: -6009, target: \"Monitor.cpp\"}]\n\n  fuzzysort.highlight(fuzzysort.single('fs', 'Fuzzy Search'), '<b>', '</b>')\n  // <b>F</b>uzzy <b>S</b>earch\n*/\n\n// UMD (Universal Module Definition) for fuzzysort\n;(function(root, UMD) {\n  if(typeof define === 'function' && define.amd) define([], UMD)\n  else if(typeof module === 'object' && module.exports) module.exports = UMD()\n  else root.fuzzysort = UMD()\n})(this, function UMD() { function fuzzysortNew(instanceOptions) {\n\n  var fuzzysort = {\n\n    single: function(search, target, options) {\n      if(!search) return null\n      if(!isObj(search)) search = fuzzysort.getPreparedSearch(search)\n\n      if(!target) return null\n      if(!isObj(target)) target = fuzzysort.getPrepared(target)\n\n      var allowTypo = options && options.allowTypo!==undefined ? options.allowTypo\n        : instanceOptions && instanceOptions.allowTypo!==undefined ? instanceOptions.allowTypo\n        : true\n      var algorithm = allowTypo ? fuzzysort.algorithm : fuzzysort.algorithmNoTypo\n      return algorithm(search, target, search[0])\n      // var threshold = options && options.threshold || instanceOptions && instanceOptions.threshold || -9007199254740991\n      // var result = algorithm(search, target, search[0])\n      // if(result === null) return null\n      // if(result.score < threshold) return null\n      // return result\n    },\n\n    go: function(search, targets, options) {\n      if(!search) return noResults\n      search = fuzzysort.prepareSearch(search)\n      var searchLowerCode = search[0]\n\n      var threshold = options && options.threshold || instanceOptions && instanceOptions.threshold || -9007199254740991\n      var limit = options && options.limit || instanceOptions && instanceOptions.limit || 9007199254740991\n      var allowTypo = options && options.allowTypo!==undefined ? options.allowTypo\n        : instanceOptions && instanceOptions.allowTypo!==undefined ? instanceOptions.allowTypo\n        : true\n      var algorithm = allowTypo ? fuzzysort.algorithm : fuzzysort.algorithmNoTypo\n      var resultsLen = 0; var limitedCount = 0\n      var targetsLen = targets.length\n\n      // This code is copy/pasted 3 times for performance reasons [options.keys, options.key, no keys]\n\n      // options.keys\n      if(options && options.keys) {\n        var scoreFn = options.scoreFn || defaultScoreFn\n        var keys = options.keys\n        var keysLen = keys.length\n        for(var i = targetsLen - 1; i >= 0; --i) { var obj = targets[i]\n          var objResults = new Array(keysLen)\n          for (var keyI = keysLen - 1; keyI >= 0; --keyI) {\n            var key = keys[keyI]\n            var target = getValue(obj, key)\n            if(!target) { objResults[keyI] = null; continue }\n            if(!isObj(target)) target = fuzzysort.getPrepared(target)\n\n            objResults[keyI] = algorithm(search, target, searchLowerCode)\n          }\n          objResults.obj = obj // before scoreFn so scoreFn can use it\n          var score = scoreFn(objResults)\n          if(score === null) continue\n          if(score < threshold) continue\n          objResults.score = score\n          if(resultsLen < limit) { q.add(objResults); ++resultsLen }\n          else {\n            ++limitedCount\n            if(score > q.peek().score) q.replaceTop(objResults)\n          }\n        }\n\n      // options.key\n      } else if(options && options.key) {\n        var key = options.key\n        for(var i = targetsLen - 1; i >= 0; --i) { var obj = targets[i]\n          var target = getValue(obj, key)\n          if(!target) continue\n          if(!isObj(target)) target = fuzzysort.getPrepared(target)\n\n          var result = algorithm(search, target, searchLowerCode)\n          if(result === null) continue\n          if(result.score < threshold) continue\n\n          // have to clone result so duplicate targets from different obj can each reference the correct obj\n          result = {target:result.target, _targetLowerCodes:null, _nextBeginningIndexes:null, score:result.score, indexes:result.indexes, obj:obj} // hidden\n\n          if(resultsLen < limit) { q.add(result); ++resultsLen }\n          else {\n            ++limitedCount\n            if(result.score > q.peek().score) q.replaceTop(result)\n          }\n        }\n\n      // no keys\n      } else {\n        for(var i = targetsLen - 1; i >= 0; --i) { var target = targets[i]\n          if(!target) continue\n          if(!isObj(target)) target = fuzzysort.getPrepared(target)\n\n          var result = algorithm(search, target, searchLowerCode)\n          if(result === null) continue\n          if(result.score < threshold) continue\n          if(resultsLen < limit) { q.add(result); ++resultsLen }\n          else {\n            ++limitedCount\n            if(result.score > q.peek().score) q.replaceTop(result)\n          }\n        }\n      }\n\n      if(resultsLen === 0) return noResults\n      var results = new Array(resultsLen)\n      for(var i = resultsLen - 1; i >= 0; --i) results[i] = q.poll()\n      results.total = resultsLen + limitedCount\n      return results\n    },\n\n    goAsync: function(search, targets, options) {\n      var canceled = false\n      var p = new Promise(function(resolve, reject) {\n        if(!search) return resolve(noResults)\n        search = fuzzysort.prepareSearch(search)\n        var searchLowerCode = search[0]\n\n        var q = fastpriorityqueue()\n        var iCurrent = targets.length - 1\n        var threshold = options && options.threshold || instanceOptions && instanceOptions.threshold || -9007199254740991\n        var limit = options && options.limit || instanceOptions && instanceOptions.limit || 9007199254740991\n        var allowTypo = options && options.allowTypo!==undefined ? options.allowTypo\n          : instanceOptions && instanceOptions.allowTypo!==undefined ? instanceOptions.allowTypo\n          : true\n        var algorithm = allowTypo ? fuzzysort.algorithm : fuzzysort.algorithmNoTypo\n        var resultsLen = 0; var limitedCount = 0\n        function step() {\n          if(canceled) return reject('canceled')\n\n          var startMs = Date.now()\n\n          // This code is copy/pasted 3 times for performance reasons [options.keys, options.key, no keys]\n\n          // options.keys\n          if(options && options.keys) {\n            var scoreFn = options.scoreFn || defaultScoreFn\n            var keys = options.keys\n            var keysLen = keys.length\n            for(; iCurrent >= 0; --iCurrent) { var obj = targets[iCurrent]\n              var objResults = new Array(keysLen)\n              for (var keyI = keysLen - 1; keyI >= 0; --keyI) {\n                var key = keys[keyI]\n                var target = getValue(obj, key)\n                if(!target) { objResults[keyI] = null; continue }\n                if(!isObj(target)) target = fuzzysort.getPrepared(target)\n\n                objResults[keyI] = algorithm(search, target, searchLowerCode)\n              }\n              objResults.obj = obj // before scoreFn so scoreFn can use it\n              var score = scoreFn(objResults)\n              if(score === null) continue\n              if(score < threshold) continue\n              objResults.score = score\n              if(resultsLen < limit) { q.add(objResults); ++resultsLen }\n              else {\n                ++limitedCount\n                if(score > q.peek().score) q.replaceTop(objResults)\n              }\n\n              if(iCurrent%1000/*itemsPerCheck*/ === 0) {\n                if(Date.now() - startMs >= 10/*asyncInterval*/) {\n                  isNode?setImmediate(step):setTimeout(step)\n                  return\n                }\n              }\n            }\n\n          // options.key\n          } else if(options && options.key) {\n            var key = options.key\n            for(; iCurrent >= 0; --iCurrent) { var obj = targets[iCurrent]\n              var target = getValue(obj, key)\n              if(!target) continue\n              if(!isObj(target)) target = fuzzysort.getPrepared(target)\n\n              var result = algorithm(search, target, searchLowerCode)\n              if(result === null) continue\n              if(result.score < threshold) continue\n\n              // have to clone result so duplicate targets from different obj can each reference the correct obj\n              result = {target:result.target, _targetLowerCodes:null, _nextBeginningIndexes:null, score:result.score, indexes:result.indexes, obj:obj} // hidden\n\n              if(resultsLen < limit) { q.add(result); ++resultsLen }\n              else {\n                ++limitedCount\n                if(result.score > q.peek().score) q.replaceTop(result)\n              }\n\n              if(iCurrent%1000/*itemsPerCheck*/ === 0) {\n                if(Date.now() - startMs >= 10/*asyncInterval*/) {\n                  isNode?setImmediate(step):setTimeout(step)\n                  return\n                }\n              }\n            }\n\n          // no keys\n          } else {\n            for(; iCurrent >= 0; --iCurrent) { var target = targets[iCurrent]\n              if(!target) continue\n              if(!isObj(target)) target = fuzzysort.getPrepared(target)\n\n              var result = algorithm(search, target, searchLowerCode)\n              if(result === null) continue\n              if(result.score < threshold) continue\n              if(resultsLen < limit) { q.add(result); ++resultsLen }\n              else {\n                ++limitedCount\n                if(result.score > q.peek().score) q.replaceTop(result)\n              }\n\n              if(iCurrent%1000/*itemsPerCheck*/ === 0) {\n                if(Date.now() - startMs >= 10/*asyncInterval*/) {\n                  isNode?setImmediate(step):setTimeout(step)\n                  return\n                }\n              }\n            }\n          }\n\n          if(resultsLen === 0) return resolve(noResults)\n          var results = new Array(resultsLen)\n          for(var i = resultsLen - 1; i >= 0; --i) results[i] = q.poll()\n          results.total = resultsLen + limitedCount\n          resolve(results)\n        }\n\n        isNode?setImmediate(step):step()\n      })\n      p.cancel = function() { canceled = true }\n      return p\n    },\n\n    highlight: function(result, hOpen, hClose) {\n      if(result === null) return null\n      if(hOpen === undefined) hOpen = '<b>'\n      if(hClose === undefined) hClose = '</b>'\n      var highlighted = ''\n      var matchesIndex = 0\n      var opened = false\n      var target = result.target\n      var targetLen = target.length\n      var matchesBest = result.indexes\n      for(var i = 0; i < targetLen; ++i) { var char = target[i]\n        if(matchesBest[matchesIndex] === i) {\n          ++matchesIndex\n          if(!opened) { opened = true\n            highlighted += hOpen\n          }\n\n          if(matchesIndex === matchesBest.length) {\n            highlighted += char + hClose + target.substr(i+1)\n            break\n          }\n        } else {\n          if(opened) { opened = false\n            highlighted += hClose\n          }\n        }\n        highlighted += char\n      }\n\n      return highlighted\n    },\n\n    prepare: function(target) {\n      if(!target) return\n      return {target:target, _targetLowerCodes:fuzzysort.prepareLowerCodes(target), _nextBeginningIndexes:null, score:null, indexes:null, obj:null} // hidden\n    },\n    prepareSlow: function(target) {\n      if(!target) return\n      return {target:target, _targetLowerCodes:fuzzysort.prepareLowerCodes(target), _nextBeginningIndexes:fuzzysort.prepareNextBeginningIndexes(target), score:null, indexes:null, obj:null} // hidden\n    },\n    prepareSearch: function(search) {\n      if(!search) return\n      return fuzzysort.prepareLowerCodes(search)\n    },\n\n\n\n    // Below this point is only internal code\n    // Below this point is only internal code\n    // Below this point is only internal code\n    // Below this point is only internal code\n\n\n\n    getPrepared: function(target) {\n      if(target.length > 999) return fuzzysort.prepare(target) // don't cache huge targets\n      var targetPrepared = preparedCache.get(target)\n      if(targetPrepared !== undefined) return targetPrepared\n      targetPrepared = fuzzysort.prepare(target)\n      preparedCache.set(target, targetPrepared)\n      return targetPrepared\n    },\n    getPreparedSearch: function(search) {\n      if(search.length > 999) return fuzzysort.prepareSearch(search) // don't cache huge searches\n      var searchPrepared = preparedSearchCache.get(search)\n      if(searchPrepared !== undefined) return searchPrepared\n      searchPrepared = fuzzysort.prepareSearch(search)\n      preparedSearchCache.set(search, searchPrepared)\n      return searchPrepared\n    },\n\n    algorithm: function(searchLowerCodes, prepared, searchLowerCode) {\n      var targetLowerCodes = prepared._targetLowerCodes\n      var searchLen = searchLowerCodes.length\n      var targetLen = targetLowerCodes.length\n      var searchI = 0 // where we at\n      var targetI = 0 // where you at\n      var typoSimpleI = 0\n      var matchesSimpleLen = 0\n\n      // very basic fuzzy match; to remove non-matching targets ASAP!\n      // walk through target. find sequential matches.\n      // if all chars aren't found then exit\n      for(;;) {\n        var isMatch = searchLowerCode === targetLowerCodes[targetI]\n        if(isMatch) {\n          matchesSimple[matchesSimpleLen++] = targetI\n          ++searchI; if(searchI === searchLen) break\n          searchLowerCode = searchLowerCodes[typoSimpleI===0?searchI : (typoSimpleI===searchI?searchI+1 : (typoSimpleI===searchI-1?searchI-1 : searchI))]\n        }\n\n        ++targetI; if(targetI >= targetLen) { // Failed to find searchI\n          // Check for typo or exit\n          // we go as far as possible before trying to transpose\n          // then we transpose backwards until we reach the beginning\n          for(;;) {\n            if(searchI <= 1) return null // not allowed to transpose first char\n            if(typoSimpleI === 0) { // we haven't tried to transpose yet\n              --searchI\n              var searchLowerCodeNew = searchLowerCodes[searchI]\n              if(searchLowerCode === searchLowerCodeNew) continue // doesn't make sense to transpose a repeat char\n              typoSimpleI = searchI\n            } else {\n              if(typoSimpleI === 1) return null // reached the end of the line for transposing\n              --typoSimpleI\n              searchI = typoSimpleI\n              searchLowerCode = searchLowerCodes[searchI + 1]\n              var searchLowerCodeNew = searchLowerCodes[searchI]\n              if(searchLowerCode === searchLowerCodeNew) continue // doesn't make sense to transpose a repeat char\n            }\n            matchesSimpleLen = searchI\n            targetI = matchesSimple[matchesSimpleLen - 1] + 1\n            break\n          }\n        }\n      }\n\n      var searchI = 0\n      var typoStrictI = 0\n      var successStrict = false\n      var matchesStrictLen = 0\n\n      var nextBeginningIndexes = prepared._nextBeginningIndexes\n      if(nextBeginningIndexes === null) nextBeginningIndexes = prepared._nextBeginningIndexes = fuzzysort.prepareNextBeginningIndexes(prepared.target)\n      var firstPossibleI = targetI = matchesSimple[0]===0 ? 0 : nextBeginningIndexes[matchesSimple[0]-1]\n\n      // Our target string successfully matched all characters in sequence!\n      // Let's try a more advanced and strict test to improve the score\n      // only count it as a match if it's consecutive or a beginning character!\n      if(targetI !== targetLen) for(;;) {\n        if(targetI >= targetLen) {\n          // We failed to find a good spot for this search char, go back to the previous search char and force it forward\n          if(searchI <= 0) { // We failed to push chars forward for a better match\n            // transpose, starting from the beginning\n            ++typoStrictI; if(typoStrictI > searchLen-2) break\n            if(searchLowerCodes[typoStrictI] === searchLowerCodes[typoStrictI+1]) continue // doesn't make sense to transpose a repeat char\n            targetI = firstPossibleI\n            continue\n          }\n\n          --searchI\n          var lastMatch = matchesStrict[--matchesStrictLen]\n          targetI = nextBeginningIndexes[lastMatch]\n\n        } else {\n          var isMatch = searchLowerCodes[typoStrictI===0?searchI : (typoStrictI===searchI?searchI+1 : (typoStrictI===searchI-1?searchI-1 : searchI))] === targetLowerCodes[targetI]\n          if(isMatch) {\n            matchesStrict[matchesStrictLen++] = targetI\n            ++searchI; if(searchI === searchLen) { successStrict = true; break }\n            ++targetI\n          } else {\n            targetI = nextBeginningIndexes[targetI]\n          }\n        }\n      }\n\n      { // tally up the score & keep track of matches for highlighting later\n        if(successStrict) { var matchesBest = matchesStrict; var matchesBestLen = matchesStrictLen }\n        else { var matchesBest = matchesSimple; var matchesBestLen = matchesSimpleLen }\n        var score = 0\n        var lastTargetI = -1\n        for(var i = 0; i < searchLen; ++i) { var targetI = matchesBest[i]\n          // score only goes down if they're not consecutive\n          if(lastTargetI !== targetI - 1) score -= targetI\n          lastTargetI = targetI\n        }\n        if(!successStrict) {\n          score *= 1000\n          if(typoSimpleI !== 0) score += -20/*typoPenalty*/\n        } else {\n          if(typoStrictI !== 0) score += -20/*typoPenalty*/\n        }\n        score -= targetLen - searchLen\n        prepared.score = score\n        prepared.indexes = new Array(matchesBestLen); for(var i = matchesBestLen - 1; i >= 0; --i) prepared.indexes[i] = matchesBest[i]\n\n        return prepared\n      }\n    },\n\n    algorithmNoTypo: function(searchLowerCodes, prepared, searchLowerCode) {\n      var targetLowerCodes = prepared._targetLowerCodes\n      var searchLen = searchLowerCodes.length\n      var targetLen = targetLowerCodes.length\n      var searchI = 0 // where we at\n      var targetI = 0 // where you at\n      var matchesSimpleLen = 0\n\n      // very basic fuzzy match; to remove non-matching targets ASAP!\n      // walk through target. find sequential matches.\n      // if all chars aren't found then exit\n      for(;;) {\n        var isMatch = searchLowerCode === targetLowerCodes[targetI]\n        if(isMatch) {\n          matchesSimple[matchesSimpleLen++] = targetI\n          ++searchI; if(searchI === searchLen) break\n          searchLowerCode = searchLowerCodes[searchI]\n        }\n        ++targetI; if(targetI >= targetLen) return null // Failed to find searchI\n      }\n\n      var searchI = 0\n      var successStrict = false\n      var matchesStrictLen = 0\n\n      var nextBeginningIndexes = prepared._nextBeginningIndexes\n      if(nextBeginningIndexes === null) nextBeginningIndexes = prepared._nextBeginningIndexes = fuzzysort.prepareNextBeginningIndexes(prepared.target)\n      var firstPossibleI = targetI = matchesSimple[0]===0 ? 0 : nextBeginningIndexes[matchesSimple[0]-1]\n\n      // Our target string successfully matched all characters in sequence!\n      // Let's try a more advanced and strict test to improve the score\n      // only count it as a match if it's consecutive or a beginning character!\n      if(targetI !== targetLen) for(;;) {\n        if(targetI >= targetLen) {\n          // We failed to find a good spot for this search char, go back to the previous search char and force it forward\n          if(searchI <= 0) break // We failed to push chars forward for a better match\n\n          --searchI\n          var lastMatch = matchesStrict[--matchesStrictLen]\n          targetI = nextBeginningIndexes[lastMatch]\n\n        } else {\n          var isMatch = searchLowerCodes[searchI] === targetLowerCodes[targetI]\n          if(isMatch) {\n            matchesStrict[matchesStrictLen++] = targetI\n            ++searchI; if(searchI === searchLen) { successStrict = true; break }\n            ++targetI\n          } else {\n            targetI = nextBeginningIndexes[targetI]\n          }\n        }\n      }\n\n      { // tally up the score & keep track of matches for highlighting later\n        if(successStrict) { var matchesBest = matchesStrict; var matchesBestLen = matchesStrictLen }\n        else { var matchesBest = matchesSimple; var matchesBestLen = matchesSimpleLen }\n        var score = 0\n        var lastTargetI = -1\n        for(var i = 0; i < searchLen; ++i) { var targetI = matchesBest[i]\n          // score only goes down if they're not consecutive\n          if(lastTargetI !== targetI - 1) score -= targetI\n          lastTargetI = targetI\n        }\n        if(!successStrict) score *= 1000\n        score -= targetLen - searchLen\n        prepared.score = score\n        prepared.indexes = new Array(matchesBestLen); for(var i = matchesBestLen - 1; i >= 0; --i) prepared.indexes[i] = matchesBest[i]\n\n        return prepared\n      }\n    },\n\n    prepareLowerCodes: function(str) {\n      var strLen = str.length\n      var lowerCodes = [] // new Array(strLen)    sparse array is too slow\n      var lower = str.toLowerCase()\n      for(var i = 0; i < strLen; ++i) lowerCodes[i] = lower.charCodeAt(i)\n      return lowerCodes\n    },\n    prepareBeginningIndexes: function(target) {\n      var targetLen = target.length\n      var beginningIndexes = []; var beginningIndexesLen = 0\n      var wasUpper = false\n      var wasAlphanum = false\n      for(var i = 0; i < targetLen; ++i) {\n        var targetCode = target.charCodeAt(i)\n        var isUpper = targetCode>=65&&targetCode<=90\n        var isAlphanum = isUpper || targetCode>=97&&targetCode<=122 || targetCode>=48&&targetCode<=57\n        var isBeginning = isUpper && !wasUpper || !wasAlphanum || !isAlphanum\n        wasUpper = isUpper\n        wasAlphanum = isAlphanum\n        if(isBeginning) beginningIndexes[beginningIndexesLen++] = i\n      }\n      return beginningIndexes\n    },\n    prepareNextBeginningIndexes: function(target) {\n      var targetLen = target.length\n      var beginningIndexes = fuzzysort.prepareBeginningIndexes(target)\n      var nextBeginningIndexes = [] // new Array(targetLen)     sparse array is too slow\n      var lastIsBeginning = beginningIndexes[0]\n      var lastIsBeginningI = 0\n      for(var i = 0; i < targetLen; ++i) {\n        if(lastIsBeginning > i) {\n          nextBeginningIndexes[i] = lastIsBeginning\n        } else {\n          lastIsBeginning = beginningIndexes[++lastIsBeginningI]\n          nextBeginningIndexes[i] = lastIsBeginning===undefined ? targetLen : lastIsBeginning\n        }\n      }\n      return nextBeginningIndexes\n    },\n\n    cleanup: cleanup,\n    new: fuzzysortNew,\n  }\n  return fuzzysort\n} // fuzzysortNew\n\n// This stuff is outside fuzzysortNew, because it's shared with instances of fuzzysort.new()\nvar isNode = typeof require !== 'undefined' && typeof window === 'undefined'\n// var MAX_INT = Number.MAX_SAFE_INTEGER\n// var MIN_INT = Number.MIN_VALUE\nvar preparedCache = new Map()\nvar preparedSearchCache = new Map()\nvar noResults = []; noResults.total = 0\nvar matchesSimple = []; var matchesStrict = []\nfunction cleanup() { preparedCache.clear(); preparedSearchCache.clear(); matchesSimple = []; matchesStrict = [] }\nfunction defaultScoreFn(a) {\n  var max = -9007199254740991\n  for (var i = a.length - 1; i >= 0; --i) {\n    var result = a[i]; if(result === null) continue\n    var score = result.score\n    if(score > max) max = score\n  }\n  if(max === -9007199254740991) return null\n  return max\n}\n\n// prop = 'key'              2.5ms optimized for this case, seems to be about as fast as direct obj[prop]\n// prop = 'key1.key2'        10ms\n// prop = ['key1', 'key2']   27ms\nfunction getValue(obj, prop) {\n  var tmp = obj[prop]; if(tmp !== undefined) return tmp\n  var segs = prop\n  if(!Array.isArray(prop)) segs = prop.split('.')\n  var len = segs.length\n  var i = -1\n  while (obj && (++i < len)) obj = obj[segs[i]]\n  return obj\n}\n\nfunction isObj(x) { return typeof x === 'object' } // faster as a function\n\n// Hacked version of https://github.com/lemire/FastPriorityQueue.js\nvar fastpriorityqueue=function(){var r=[],o=0,e={};function n(){for(var e=0,n=r[e],c=1;c<o;){var f=c+1;e=c,f<o&&r[f].score<r[c].score&&(e=f),r[e-1>>1]=r[e],c=1+(e<<1)}for(var a=e-1>>1;e>0&&n.score<r[a].score;a=(e=a)-1>>1)r[e]=r[a];r[e]=n}return e.add=function(e){var n=o;r[o++]=e;for(var c=n-1>>1;n>0&&e.score<r[c].score;c=(n=c)-1>>1)r[n]=r[c];r[n]=e},e.poll=function(){if(0!==o){var e=r[0];return r[0]=r[--o],n(),e}},e.peek=function(e){if(0!==o)return r[0]},e.replaceTop=function(o){r[0]=o,n()},e};\nvar q = fastpriorityqueue() // reuse this, except for async, it needs to make its own\n\nreturn fuzzysortNew()\n}) // UMD\n\n// TODO: (performance) wasm version!?\n\n// TODO: (performance) layout memory in an optimal way to go fast by avoiding cache misses\n\n// TODO: (performance) preparedCache is a memory leak\n\n// TODO: (like sublime) backslash === forwardslash\n\n// TODO: (performance) i have no idea how well optizmied the allowing typos algorithm is\n\n'use strict';\n/**\n * @requires ../node_modules/fuzzysort/fuzzysort.js\n */\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar GhostSearch =\n/*#__PURE__*/\nfunction () {\n  function GhostSearch(args) {\n    _classCallCheck(this, GhostSearch);\n\n    this.check = false;\n    var defaults = {\n      host: '',\n      key: '',\n      version: 'v2',\n      input: '#ghost-search-field',\n      results: '#ghost-search-results',\n      button: '',\n      defaultValue: '',\n      template: function template(result) {\n        var url = [location.protocol, '//', location.host].join('');\n        return '<a href=\"' + url + '/' + result.slug + '/\">' + result.title + '</a>';\n      },\n      trigger: 'focus',\n      options: {\n        keys: ['title'],\n        limit: 10,\n        threshold: -3500,\n        allowTypo: false\n      },\n      api: {\n        resource: 'posts',\n        parameters: {\n          limit: 'all',\n          fields: ['title', 'slug'],\n          filter: '',\n          include: '',\n          order: '',\n          formats: '',\n          page: ''\n        }\n      },\n      on: {\n        beforeDisplay: function beforeDisplay() {},\n        afterDisplay: function afterDisplay(results) {},\n        beforeFetch: function beforeFetch() {},\n        afterFetch: function afterFetch(results) {}\n      }\n    };\n    var merged = this.mergeDeep(defaults, args);\n    Object.assign(this, merged);\n    this.init();\n  }\n\n  _createClass(GhostSearch, [{\n    key: \"mergeDeep\",\n    value: function mergeDeep(target, source) {\n      var _this = this;\n\n      if (target && _typeof(target) === 'object' && !Array.isArray(target) && target !== null && source && _typeof(source) === 'object' && !Array.isArray(source) && source !== null) {\n        Object.keys(source).forEach(function (key) {\n          if (source[key] && _typeof(source[key]) === 'object' && !Array.isArray(source[key]) && source[key] !== null) {\n            if (!target[key]) Object.assign(target, _defineProperty({}, key, {}));\n\n            _this.mergeDeep(target[key], source[key]);\n          } else {\n            Object.assign(target, _defineProperty({}, key, source[key]));\n          }\n        });\n      }\n\n      return target;\n    }\n  }, {\n    key: \"fetch\",\n    value: function fetch() {\n      var _this2 = this;\n\n      this.on.beforeFetch();\n      var ghostAPI = new GhostContentAPI({\n        host: this.host,\n        key: this.key,\n        version: this.version\n      });\n      var browse = {};\n      var parameters = this.api.parameters;\n\n      for (var key in parameters) {\n        if (parameters[key] != '') {\n          browse[key] = parameters[key];\n        }\n      }\n\n      ghostAPI[this.api.resource].browse(browse).then(function (data) {\n        _this2.search(data);\n      }).catch(function (err) {\n        console.error(err);\n      });\n    }\n  }, {\n    key: \"createElementFromHTML\",\n    value: function createElementFromHTML(htmlString) {\n      var div = document.createElement('div');\n      div.innerHTML = htmlString.trim();\n      return div.firstChild;\n    }\n  }, {\n    key: \"displayResults\",\n    value: function displayResults(data) {\n      if (document.querySelectorAll(this.results)[0].firstChild !== null && document.querySelectorAll(this.results)[0].firstChild !== '') {\n        while (document.querySelectorAll(this.results)[0].firstChild) {\n          document.querySelectorAll(this.results)[0].removeChild(document.querySelectorAll(this.results)[0].firstChild);\n        }\n      }\n\n      ;\n      var inputValue = document.querySelectorAll(this.input)[0].value;\n\n      if (this.defaultValue != '') {\n        inputValue = this.defaultValue;\n      }\n\n      var results = fuzzysort.go(inputValue, data, {\n        keys: this.options.keys,\n        limit: this.options.limit,\n        allowTypo: this.options.allowTypo,\n        threshold: this.options.threshold\n      });\n\n      for (var key in results) {\n        if (key < results.length) {\n          document.querySelectorAll(this.results)[0].appendChild(this.createElementFromHTML(this.template(results[key].obj)));\n        }\n\n        ;\n      }\n\n      this.on.afterDisplay(results);\n      this.defaultValue = '';\n    }\n  }, {\n    key: \"search\",\n    value: function search(data) {\n      var _this3 = this;\n\n      this.on.afterFetch(data);\n      this.check = true;\n\n      if (this.defaultValue != '') {\n        this.on.beforeDisplay();\n        this.displayResults(data);\n      }\n\n      if (this.button != '') {\n        var button = document.querySelectorAll(this.button)[0];\n\n        if (button.tagName == 'INPUT' && button.type == 'submit') {\n          button.closest('form').addEventListener(\"submit\", function (e) {\n            e.preventDefault();\n          });\n        }\n\n        ;\n        button.addEventListener('click', function (e) {\n          e.preventDefault();\n\n          _this3.on.beforeDisplay();\n\n          _this3.displayResults(data);\n        });\n      } else {\n        document.querySelectorAll(this.input)[0].addEventListener('keyup', function (e) {\n          _this3.on.beforeDisplay();\n\n          _this3.displayResults(data);\n        });\n      }\n\n      ;\n    }\n  }, {\n    key: \"checkArgs\",\n    value: function checkArgs() {\n      if (!document.querySelectorAll(this.input).length) {\n        console.log('Input not found.');\n        return false;\n      }\n\n      if (!document.querySelectorAll(this.results).length) {\n        console.log('Results not found.');\n        return false;\n      }\n\n      ;\n\n      if (this.button != '') {\n        if (!document.querySelectorAll(this.button).length) {\n          console.log('Button not found.');\n          return false;\n        }\n\n        ;\n      }\n\n      if (this.host == '') {\n        console.log('Content API Client Library host missing. Please set the host. Must not end in a trailing slash.');\n        return false;\n      }\n\n      ;\n\n      if (this.key == '') {\n        console.log('Content API Client Library key missing. Please set the key. Hex string copied from the \"Integrations\" screen in Ghost Admin.');\n        return false;\n      }\n\n      ;\n      return true;\n    }\n  }, {\n    key: \"validate\",\n    value: function validate() {\n      if (!this.checkArgs()) {\n        return false;\n      }\n\n      ;\n      return true;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this4 = this;\n\n      if (!this.validate()) {\n        return;\n      }\n\n      if (this.defaultValue != '') {\n        document.querySelectorAll(this.input)[0].value = this.defaultValue;\n\n        window.onload = function () {\n          if (!_this4.check) {\n            _this4.fetch();\n          }\n\n          ;\n        };\n      }\n\n      if (this.trigger == 'focus') {\n        document.querySelectorAll(this.input)[0].addEventListener('focus', function (e) {\n          if (!_this4.check) {\n            _this4.fetch();\n          }\n\n          ;\n        });\n      } else if (this.trigger == 'load') {\n        window.onload = function () {\n          if (!_this4.check) {\n            _this4.fetch();\n          }\n\n          ;\n        };\n      }\n    }\n  }]);\n\n  return GhostSearch;\n}();\n\n"]}